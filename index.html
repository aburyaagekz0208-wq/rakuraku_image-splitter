<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚‰ãã‚‰ãç”»åƒåˆ†å‰²å› | ãƒ–ãƒ©ã‚¦ã‚¶ã§ç„¡æ–™ç”»åƒã‚¹ãƒ©ã‚¤ã‚¹</title>
    <meta name="description" content="ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ç”»åƒã‚’ç¸¦åˆ†å‰²ãƒ»ã‚°ãƒªãƒƒãƒ‰åˆ†å‰²ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚X(Twitter)ã®ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤ºã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ã‚¹ãƒãƒ›å¯¾å¿œã€ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œå¯èƒ½ã€‚ã‚µãƒ¼ãƒãƒ¼ã«ç”»åƒã‚’é€ä¿¡ã—ãªã„ãŸã‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚‚å®‰å…¨ã§ã™ã€‚">
    
    <style>
        /* --- åŸºæœ¬è¨­å®š --- */
        body { font-family: 'Helvetica Neue', Arial, sans-serif; background-color: #f4f7f6; color: #333; padding: 20px; line-height: 1.6; }
        .container { max-width: 700px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { font-size: 1.8rem; text-align: center; margin-bottom: 20px; color: #222; }
        
        /* --- ãƒ•ã‚©ãƒ¼ãƒ ã¨UI --- */
        .form-group { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .form-group:last-child { border-bottom: none; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #444; }
        input[type="file"], input[type="number"], select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1rem; }
        
        .radio-group { display: flex; gap: 15px; margin-top: 5px; }
        .radio-group label { font-weight: normal; display: flex; align-items: center; gap: 5px; cursor: pointer; }
        
        .grid-inputs { display: flex; gap: 15px; }
        .grid-inputs div { flex: 1; }

        .cut-point-row { display: flex; align-items: center; margin-bottom: 10px; background: #f9f9f9; padding: 10px; border-radius: 4px; }
        .cut-point-row label { margin-bottom: 0; margin-right: 15px; white-space: nowrap; font-weight: normal; width: 120px;}
        
        /* --- ãƒœã‚¿ãƒ³é¡ --- */
        button { padding: 12px; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background 0.2s; }
        .btn-primary { width: 100%; background-color: #007bff; color: white; margin-top: 10px; font-weight: bold; font-size: 1.1rem; padding: 15px;}
        .btn-primary:hover { background-color: #0056b3; }
        .btn-primary:disabled { background-color: #ccc; cursor: not-allowed; }
        .btn-secondary { background-color: #6c757d; color: white; padding: 8px 15px; font-size: 0.9rem; margin-bottom: 15px;}
        .btn-secondary:hover { background-color: #5a6268; }
        .btn-warning { background-color: #ff9800; color: white; font-weight: bold; padding: 12px 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-warning:hover { background-color: #e68a00; }

        /* --- åˆ†å‰²ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆèµ¤ç·šï¼‰ --- */
        .preview-container { text-align: center; border: 2px dashed #ccc; padding: 10px; background: #fafafa; border-radius: 4px; margin-bottom: 20px; position: relative;}
        #previewCanvas { width: 100%; height: auto; display: block; box-shadow: 0 2px 4px rgba(0,0,0,0.1); touch-action: none; }
        #previewPlaceholder { color: #999; padding: 40px 0; }
        .info-text { font-size: 0.9rem; color: #007bff; font-weight: bold; margin-top: 5px; }

        /* --- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  X(Twitter) ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ --- */
        #xPreviewArea { margin-top: 30px; margin-bottom: 30px; border: 2px solid #1da1f2; border-radius: 8px; padding: 20px; display: none; background-color: #f5f8fa; }
        .x-preview-box { background: #fff; border: 1px solid #e1e8ed; border-radius: 12px; padding: 15px; max-width: 500px; margin: 0 auto; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .x-dummy-header { display: flex; margin-bottom: 10px; }
        .x-dummy-icon { width: 40px; height: 40px; background: #ccc; border-radius: 50%; margin-right: 10px; }
        .x-dummy-text { flex: 1; }
        .x-dummy-name { font-weight: bold; font-size: 0.9rem; }
        .x-dummy-id { color: #657786; font-size: 0.85rem; }
        .x-dummy-content { font-size: 0.95rem; margin-bottom: 10px; }
        
        #xGridContainer {
            display: grid; gap: 2px; border-radius: 12px; overflow: hidden; border: 1px solid #cfd9de; aspect-ratio: 16 / 9;
        }
        /* canvasã‚’ä½¿ã£ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”» */
        .x-grid-item { position: relative; width: 100%; height: 100%; overflow: hidden; background: #f0f0f0; }
        .x-grid-item canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; /* ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ç”»åƒã®ã‚ˆã†æ ã«åˆã‚ã›ã¦ãƒˆãƒªãƒŸãƒ³ã‚° */
        }

        #xGridContainer.x-layout-1 { display: block; aspect-ratio: auto; border: none;}
        #xGridContainer.x-layout-1 .x-grid-item { border-radius: 12px; border: 1px solid #cfd9de; max-height: 500px; }
        #xGridContainer.x-layout-1 canvas { position: static; height: auto; max-height: 500px; object-fit: contain; }
        #xGridContainer.x-layout-2 { grid-template-columns: 1fr 1fr; }
        #xGridContainer.x-layout-3 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }
        #xGridContainer.x-layout-3 .x-grid-item:nth-child(1) { grid-row: span 2; }
        #xGridContainer.x-layout-4 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }

        /* --- å‡ºåŠ›çµæœ --- */
        #resultArea { margin-top: 40px; border-top: 3px solid #28a745; padding-top: 20px; display: none; }
        .result-grid { display: grid; gap: 15px; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); margin-bottom: 20px; }
        .result-item { text-align: center; background: #fdfdfd; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        .result-item img { max-width: 100%; height: auto; display: block; margin: 0 auto 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .download-btn { display: inline-block; background-color: #28a745; color: white; padding: 8px 15px; text-decoration: none; border-radius: 4px; font-weight: bold; font-size: 0.9rem;}
        
        /* --- SEOå¯¾ç­–ç”¨ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ --- */
        .seo-content { margin-top: 50px; border-top: 2px solid #eee; padding-top: 20px; }
        details { background: #fff; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 6px; overflow: hidden; }
        summary { background: #f8f9fa; padding: 15px; font-weight: bold; cursor: pointer; list-style: none; display: flex; justify-content: space-between; align-items: center; }
        summary::-webkit-details-marker { display: none; }
        summary::after { content: "â–¼"; font-size: 0.8rem; color: #666; transition: transform 0.2s; }
        details[open] summary::after { transform: rotate(180deg); }
        .details-inner { padding: 20px; font-size: 0.95rem; color: #555; border-top: 1px solid #eee; }
        .details-inner h3 { margin-top: 0; color: #333; font-size: 1.1rem; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .details-inner ul { padding-left: 20px; margin-bottom: 0; }
        .details-inner li { margin-bottom: 10px; }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3769360007517865"
     crossorigin="anonymous"></script>
</head>
<body>

<div class="container">
    <h1>ã‚‰ãã‚‰ãç”»åƒåˆ†å‰²å›</h1>
    
    <div class="form-group">
        <label for="imageInput">1. ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</label>
        <input type="file" id="imageInput" accept="image/png, image/jpeg, image/webp">
        <div id="imageInfo" class="info-text"></div>
    </div>

    <div class="form-group" id="modeGroup" style="display: none;">
        <label>2. åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ</label>
        <div class="radio-group">
            <label><input type="radio" name="splitMode" value="vertical" checked> ç¸¦åˆ†å‰²ï¼ˆè‡ªç”±é…ç½®ï¼‰</label>
            <label><input type="radio" name="splitMode" value="grid"> ç¸¦ï¼‹æ¨ªï¼ˆå‡ç­‰ã‚°ãƒªãƒƒãƒ‰ï¼‰</label>
        </div>
    </div>

    <div class="form-group" id="previewGroup" style="display: none;">
        <label>åˆ†å‰²ä½ç½®ã®èª¿æ•´ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰</label>
        <div class="preview-container">
            <div id="previewPlaceholder">ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
            <canvas id="previewCanvas" style="display: none;"></canvas>
        </div>
    </div>

    <div id="verticalSettings" style="display: none;">
        <div class="form-group">
            <label for="splitCount">3. ç¸¦ã®åˆ†å‰²æ•°</label>
            <input type="number" id="splitCount" value="2" min="2" max="50">
        </div>
        <div class="form-group">
            <label>4. ã‚«ãƒƒãƒˆä½ç½®ã®ãƒ”ã‚¯ã‚»ãƒ«æ•°ã‚’æŒ‡å®š (px) <br><small style="font-weight:normal; color:#666;">â€»ä¸Šã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§èµ¤ã„ç·šã‚’ç›´æ¥ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦èª¿æ•´ã§ãã¾ã™</small></label>
            <button type="button" id="resetEvenBtn" class="btn-secondary">ğŸ”„ å‡ç­‰å‰²ã‚Šã«ãƒªã‚»ãƒƒãƒˆ</button>
            <div id="cutPointsContainer"></div>
        </div>
    </div>

    <div id="gridSettings" style="display: none;">
        <div class="form-group grid-inputs">
            <div>
                <label for="gridRows">ç¸¦ã®åˆ†å‰²æ•° (è¡Œ)</label>
                <input type="number" id="gridRows" value="2" min="1" max="20">
            </div>
            <div>
                <label for="gridCols">æ¨ªã®åˆ†å‰²æ•° (åˆ—)</label>
                <input type="number" id="gridCols" value="2" min="1" max="20">
            </div>
        </div>
        <p style="font-size: 0.85rem; color: #666; margin-top: -10px;">â€»ã‚°ãƒªãƒƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ã¯æŒ‡å®šã—ãŸæ•°ã§å‡ç­‰ã«è‡ªå‹•åˆ†å‰²ã•ã‚Œã¾ã™ã€‚</p>
    </div>

    <div id="xPreviewArea">
        <h2 style="text-align: center; color: #1da1f2; margin-top: 0; margin-bottom: 15px; font-size: 1.3rem;">ğŸ“± X (Twitter) æŠ•ç¨¿æ™‚ã®è¦‹ãˆæ–¹</h2>
        <p style="text-align: center; font-size: 0.85rem; margin-top: -10px; color: #666;">â€»ç·šã‚’å‹•ã‹ã™ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åæ˜ ã•ã‚Œã¾ã™ï¼ˆ5æšä»¥ä¸Šã®å ´åˆã¯å…ˆé ­4æšï¼‰</p>
        
        <div class="x-preview-box">
            <div class="x-dummy-header">
                <div class="x-dummy-icon"></div>
                <div class="x-dummy-text">
                    <div class="x-dummy-name">ã‚ãªãŸã®åå‰ <span class="x-dummy-id">@your_id Â· ä»Š</span></div>
                    <div class="x-dummy-content">åˆ†å‰²ã—ãŸç”»åƒã‚’æŠ•ç¨¿ã™ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ #ç”»åƒåˆ†å‰²</div>
                </div>
            </div>
            <div id="xGridContainer"></div>
        </div>
    </div>

    <button id="processBtn" class="btn-primary" disabled>âœ‚ï¸ åˆ†å‰²ã—ã¦ç”»åƒã‚’å‡ºåŠ›ã™ã‚‹</button>

    <div id="resultArea">
        <h2 style="text-align: center; color: #28a745;">å‡ºåŠ›çµæœï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰</h2>
        <div style="text-align: center; margin-bottom: 20px;">
            <button id="downloadAllBtn" class="btn-warning">ğŸ“¦ ã™ã¹ã¦ä¸€æ‹¬ä¿å­˜</button>
        </div>
        <div id="resultContainer" class="result-grid"></div>
    </div>

    <div class="seo-content">
        <details open>
            <summary>ä½¿ã„æ–¹</summary>
            <div class="details-inner">
                <h3>ç°¡å˜æ“ä½œã§æ„Ÿè¦šçš„ã«ç”»åƒåˆ†å‰²</h3>
                <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ç”»åƒã‚’åˆ†å‰²ã§ãã‚‹ãŠåŠ©ã‘ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</p>
                <ol>
                    <li><strong>ç”»åƒã®é¸æŠ:</strong> ä¸Šéƒ¨ã®ã€Œç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã‹ã‚‰ã€åˆ†å‰²ã—ãŸã„ç”»åƒï¼ˆJPG, PNGç­‰ï¼‰ã‚’é¸ã³ã¾ã™ã€‚</li>
                    <li><strong>ãƒ¢ãƒ¼ãƒ‰ã®é¸æŠ:</strong> ç¸¦æ–¹å‘ã«ã‚¹ãƒ©ã‚¤ã‚¹ã™ã‚‹ã€Œç¸¦åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ã€ã‹ã€ç¸¦æ¨ªã«å‡ç­‰ã«åˆ‡ã‚Šåˆ†ã‘ã‚‹ã€Œã‚°ãƒªãƒƒãƒ‰åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ã€ã‚’é¸æŠã—ã¾ã™ã€‚</li>
                    <li><strong>ä½ç½®ã®èª¿æ•´:</strong> ç¸¦åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹èµ¤ã„ç·šã‚’ãƒã‚¦ã‚¹ã‚„æŒ‡ã§ä¸Šä¸‹ã«ãƒ‰ãƒ©ãƒƒã‚°ã™ã‚‹ã“ã¨ã§ã€ç›´æ„Ÿçš„ã«ã‚«ãƒƒãƒˆä½ç½®ã‚’å¾®èª¿æ•´ã§ãã¾ã™ã€‚X(Twitter)ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§å®Ÿéš›ã®ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³æŠ•ç¨¿ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¢ºèªã—ãªãŒã‚‰èª¿æ•´ã—ã¦ãã ã•ã„ã€‚</li>
                    <li><strong>ä¿å­˜:</strong> ã€Œåˆ†å‰²ã—ã¦ç”»åƒã‚’å‡ºåŠ›ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã€Œä¸€æ‹¬ä¿å­˜ã€ãƒœã‚¿ãƒ³ã§å…¨ã¦ã®ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚</li>
                </ol>
            </div>
        </details>
        <details>
            <summary>ä¾¿åˆ©ãªæ´»ç”¨äº‹ä¾‹</summary>
            <div class="details-inner">
                <h3>ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã®ä½œæ¥­ã‚’åŠ¹ç‡åŒ–ã™ã‚‹ä½¿ã„æ–¹</h3>
                <ul>
                    <li><strong>SNSã¸ã®æœ€é©åŒ–ï¼ˆXç­‰ï¼‰:</strong> ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ã®è¦‹ãˆæ–¹ã‚’ç¢ºèªã—ãªãŒã‚‰ã€ç¸¦é•·ç”»åƒã‚’2åˆ†å‰²ã‚„4åˆ†å‰²ï¼ˆã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºï¼‰ã®å‡¦ç†ã‚’åŠ¹ç‡çš„ã«è¡Œãˆã¾ã™ã€‚</li>
                    <li><strong>ãƒ–ãƒ­ã‚°ãƒ»noteè¨˜äº‹ç”¨ã®ç´ æä½œæˆ:</strong> noteã®é€£è¼‰è¨˜äº‹ã‚„ãƒ–ãƒ­ã‚°ç”¨ã«ã€å¤§ããªå›³è§£ã‚’16:9ãªã©ã®è¦‹ã‚„ã™ã„æ¯”ç‡ã«ã‚¹ãƒ©ã‚¤ã‚¹ã—ã¦é…ç½®ã—ãŸã„å ´åˆã«æ´»èºã—ã¾ã™ã€‚</li>
                    <li><strong>Webtoonï¼ˆç¸¦èª­ã¿ãƒãƒ³ã‚¬ï¼‰ã®åˆ¶ä½œ:</strong> é•·å°ºã®ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ³ã‚¬ã‚’ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å…ˆã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®è¦å®šã‚µã‚¤ã‚ºï¼ˆé«˜ã•ä¸Šé™ï¼‰ã«åˆã‚ã›ã¦ä¸€æ‹¬ã‚«ãƒƒãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</li>
                </ul>
            </div>
        </details>
        <details>
            <summary>ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</summary>
            <div class="details-inner">
                <h3>å®‰å…¨æ€§ã¨ä»•æ§˜ã«ã¤ã„ã¦</h3>
                <ul>
                    <li><strong>Q. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã¯å¤–éƒ¨ã«æµå‡ºãƒ»ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã‹ï¼Ÿ</strong><br>
                    A. ã¯ã„ã€ä¸€åˆ‡ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚å½“ãƒ„ãƒ¼ãƒ«ã®ç”»åƒå‡¦ç†ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã®å†…éƒ¨ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰ã§è¡Œã‚ã‚Œã¾ã™ã€‚å¤–éƒ¨ã®ã‚µãƒ¼ãƒãƒ¼ã«ç”»åƒãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã¯ç‰©ç†çš„ã«ãªã„ãŸã‚ã€æ©Ÿå¯†æƒ…å ±ã‚„æœªå…¬é–‹ã®ã‚¤ãƒ©ã‚¹ãƒˆã§ã‚‚å®‰å…¨ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚</li>
                    <li><strong>Q. ã‚¹ãƒãƒ›ã‚„ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã§ã‚‚ä½¿ãˆã¾ã™ã‹ï¼Ÿ</strong><br>
                    A. ã¯ã„ã€iOSã‚„Androidã®æ¨™æº–ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆSafariã‚„Chromeï¼‰ã§å•é¡Œãªãå‹•ä½œã—ã¾ã™ã€‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®èµ¤ã„ç·šã‚‚ã‚¿ãƒƒãƒæ“ä½œã§ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ã§ã™ã€‚</li>
                    <li><strong>Q. å•†ç”¨åˆ©ç”¨ã¯å¯èƒ½ã§ã™ã‹ï¼Ÿ</strong><br>
                    A. ã‚‚ã¡ã‚ã‚“ã§ã™ã€å½“ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦åˆ†å‰²ã—ãŸç”»åƒã¯ã€å€‹äººã®è¶£å‘³ã‹ã‚‰å•†æ¥­ç”¨ã®Webãƒãƒ³ã‚¬ã€ä¼æ¥­ã®SNSé‹ç”¨ã¾ã§åˆ¶é™ãªãç„¡æ–™ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚</li>
                </ul>
            </div>
        </details>
    </div>
</div>

<script>
    let loadedImage = null;
    let currentMode = 'vertical';
    let isDragging = false;
    let draggedLineIndex = -1;

    // UIè¦ç´ ã®å–å¾—
    const imageInput = document.getElementById('imageInput');
    const imageInfo = document.getElementById('imageInfo');
    const modeRadios = document.getElementsByName('splitMode');
    
    const previewGroup = document.getElementById('previewGroup');
    const previewCanvas = document.getElementById('previewCanvas');
    const previewCtx = previewCanvas.getContext('2d');
    
    const verticalSettings = document.getElementById('verticalSettings');
    const gridSettings = document.getElementById('gridSettings');
    
    const splitCountInput = document.getElementById('splitCount');
    const cutPointsContainer = document.getElementById('cutPointsContainer');
    const resetEvenBtn = document.getElementById('resetEvenBtn');
    
    const gridRowsInput = document.getElementById('gridRows');
    const gridColsInput = document.getElementById('gridCols');
    
    const processBtn = document.getElementById('processBtn');
    const resultArea = document.getElementById('resultArea');
    const resultContainer = document.getElementById('resultContainer');
    const downloadAllBtn = document.getElementById('downloadAllBtn');

    const xPreviewArea = document.getElementById('xPreviewArea');
    const xGridContainer = document.getElementById('xGridContainer');

    // ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    imageInput.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        try {
            loadedImage = await loadImage(file);
            imageInfo.textContent = `ã‚µã‚¤ã‚º: å¹… ${loadedImage.width}px / é«˜ã• ${loadedImage.height}px`;
            
            document.getElementById('modeGroup').style.display = 'block';
            previewGroup.style.display = 'block';
            processBtn.disabled = false;
            resultArea.style.display = 'none';

            updateUIVisibility();
            generateCutInputs(); // ã“ã“ã§ drawPreview -> Xãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒèµ°ã‚‹
        } catch (error) {
            console.error(error);
            alert('ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
        }
    });

    modeRadios.forEach(radio => {
        radio.addEventListener('change', (e) => {
            currentMode = e.target.value;
            updateUIVisibility();
            drawPreview();
        });
    });

    function updateUIVisibility() {
        if (!loadedImage) return;
        if (currentMode === 'vertical') {
            verticalSettings.style.display = 'block';
            gridSettings.style.display = 'none';
            previewCanvas.style.cursor = 'crosshair';
        } else {
            verticalSettings.style.display = 'none';
            gridSettings.style.display = 'block';
            previewCanvas.style.cursor = 'default';
        }
    }

    // å…¥åŠ›ç›£è¦–
    splitCountInput.addEventListener('input', () => { if (loadedImage) generateCutInputs(); });
    resetEvenBtn.addEventListener('click', () => { if (loadedImage) generateCutInputs(); });
    gridRowsInput.addEventListener('input', drawPreview);
    gridColsInput.addEventListener('input', drawPreview);

    function calculateEvenCuts(totalHeight, count) {
        const baseHeight = Math.floor(totalHeight / count);
        const remainder = totalHeight % count;
        const cuts = [];
        let currentY = 0;
        for (let i = 1; i < count; i++) {
            currentY += baseHeight + (i <= remainder ? 1 : 0);
            cuts.push(currentY);
        }
        return cuts;
    }

    function generateCutInputs() {
        cutPointsContainer.innerHTML = '';
        let count = parseInt(splitCountInput.value, 10) || 2;
        const defaultCuts = calculateEvenCuts(loadedImage.height, count);

        defaultCuts.forEach((cutY, index) => {
            const row = document.createElement('div');
            row.className = 'cut-point-row';
            const label = document.createElement('label');
            label.textContent = `ä¸Šã‹ã‚‰ ${index + 1}æœ¬ç›®:`;
            const input = document.createElement('input');
            input.type = 'number';
            input.className = 'cut-input';
            input.value = cutY;
            input.addEventListener('input', drawPreview);
            row.appendChild(label);
            row.appendChild(input);
            cutPointsContainer.appendChild(row);
        });
        drawPreview();
    }

    // --- ãƒ¡ã‚¤ãƒ³ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨Xãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æ›´æ–° ---
    function drawPreview() {
        if (!loadedImage) return;
        
        // 1. èµ¤ç·šç”¨ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã®æç”»
        previewCanvas.width = loadedImage.width;
        previewCanvas.height = loadedImage.height;
        previewCtx.drawImage(loadedImage, 0, 0);

        previewCtx.strokeStyle = 'red';
        previewCtx.lineWidth = Math.max(3, Math.floor(loadedImage.width / 300)); 

        const slices = []; // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®åˆ‡ã‚ŠæŠœãåº§æ¨™é…åˆ—

        if (currentMode === 'vertical') {
            let cuts = Array.from(document.querySelectorAll('.cut-input'))
                .map(input => parseInt(input.value, 10))
                .filter(y => !isNaN(y) && y > 0 && y < loadedImage.height);
            
            // èµ¤ç·šã‚’æç”»
            cuts.forEach(y => {
                previewCtx.beginPath();
                previewCtx.moveTo(0, y);
                previewCtx.lineTo(loadedImage.width, y);
                previewCtx.stroke();
            });

            // åˆ‡ã‚ŠæŠœãé ˜åŸŸã‚’è¨ˆç®—ï¼ˆæœ€å¤§4æšåˆ†ï¼‰
            cuts.push(0, loadedImage.height);
            cuts.sort((a, b) => a - b);
            cuts = [...new Set(cuts)];
            
            for (let i = 0; i < cuts.length - 1 && slices.length < 4; i++) {
                slices.push({
                    x: 0,
                    y: cuts[i],
                    w: loadedImage.width,
                    h: cuts[i + 1] - cuts[i]
                });
            }
        } else if (currentMode === 'grid') {
            const rows = parseInt(gridRowsInput.value, 10) || 1;
            const cols = parseInt(gridColsInput.value, 10) || 1;
            const sliceW = Math.floor(loadedImage.width / cols);
            const sliceH = Math.floor(loadedImage.height / rows);

            // èµ¤ç·šã‚’æç”»
            for (let c = 1; c < cols; c++) {
                previewCtx.beginPath();
                previewCtx.moveTo(c * sliceW, 0);
                previewCtx.lineTo(c * sliceW, loadedImage.height);
                previewCtx.stroke();
            }
            for (let r = 1; r < rows; r++) {
                previewCtx.beginPath();
                previewCtx.moveTo(0, r * sliceH);
                previewCtx.lineTo(loadedImage.width, r * sliceH);
                previewCtx.stroke();
            }

            // åˆ‡ã‚ŠæŠœãé ˜åŸŸã‚’è¨ˆç®—ï¼ˆæœ€å¤§4æšåˆ†ï¼‰
            for (let r = 0; r < rows && slices.length < 4; r++) {
                for (let c = 0; c < cols && slices.length < 4; c++) {
                    slices.push({
                        x: c * sliceW,
                        y: r * sliceH,
                        w: sliceW,
                        h: sliceH
                    });
                }
            }
        }

        document.getElementById('previewPlaceholder').style.display = 'none';
        previewCanvas.style.display = 'block';

        // 2. è¨ˆç®—ã—ãŸåº§æ¨™ã‚’ã‚‚ã¨ã«ã€Xãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é«˜é€Ÿæç”»
        updateRealtimeXPreview(slices);
    }

    // --- é«˜é€Ÿãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ Xãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æç”»ã‚¨ãƒ³ã‚¸ãƒ³ ---
    function updateRealtimeXPreview(slices) {
        const count = slices.length;
        if (count === 0) {
            xPreviewArea.style.display = 'none';
            return;
        }
        
        xPreviewArea.style.display = 'block';
        xGridContainer.className = `x-layout-${count}`;

        // ã‚­ãƒ£ãƒ³ãƒã‚¹è¦ç´ ã®å†åˆ©ç”¨ï¼ˆDOMæ“ä½œã‚’æ¸›ã‚‰ã—ã¦ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã®ãƒ©ã‚°ã‚’ãªãã™ï¼‰
        let items = xGridContainer.querySelectorAll('.x-grid-item');
        if (items.length !== count) {
            xGridContainer.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const item = document.createElement('div');
                item.className = 'x-grid-item';
                const canvas = document.createElement('canvas');
                item.appendChild(canvas);
                xGridContainer.appendChild(item);
            }
            items = xGridContainer.querySelectorAll('.x-grid-item');
        }

        // å„ã‚­ãƒ£ãƒ³ãƒã‚¹ã«ç›´æ¥ç”»åƒã‚’åˆ‡ã‚ŠæŠœã„ã¦æç”»
        for (let i = 0; i < count; i++) {
            const canvas = items[i].querySelector('canvas');
            const slice = slices[i];
            
            // æç”»è² è·ã‚’ä¸‹ã’ã‚‹ãŸã‚ã€ã‚­ãƒ£ãƒ³ãƒã‚¹ã®å†…éƒ¨è§£åƒåº¦ã‚’æœ€å¤§800pxã«åˆ¶é™
            const scale = Math.min(1, 800 / slice.w); 
            const drawW = Math.floor(slice.w * scale);
            const drawH = Math.floor(slice.h * scale);
            
            // ã‚µã‚¤ã‚ºãŒå¤‰ã‚ã£ãŸæ™‚ã ã‘ãƒªã‚µã‚¤ã‚º
            if (canvas.width !== drawW) canvas.width = drawW;
            if (canvas.height !== drawH) canvas.height = drawH;
            
            const ctx = canvas.getContext('2d');
            // åˆ‡ã‚ŠæŠœãæç”» (å…ƒç”»åƒ, X, Y, W, H, ã‚­ãƒ£ãƒ³ãƒã‚¹X, ã‚­ãƒ£ãƒ³ãƒã‚¹Y, ã‚­ãƒ£ãƒ³ãƒã‚¹W, ã‚­ãƒ£ãƒ³ãƒã‚¹H)
            ctx.drawImage(loadedImage, slice.x, slice.y, slice.w, slice.h, 0, 0, drawW, drawH);
        }
    }

    // --- ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œ ---
    function getPointerY(e) {
        const rect = previewCanvas.getBoundingClientRect();
        return (e.clientY - rect.top) * (previewCanvas.height / rect.height);
    }

    previewCanvas.addEventListener('pointerdown', (e) => {
        if (!loadedImage || currentMode !== 'vertical') return;
        previewCanvas.setPointerCapture(e.pointerId); 
        const y = getPointerY(e);
        const inputs = Array.from(document.querySelectorAll('.cut-input'));
        const tolerance = 20 * (previewCanvas.height / previewCanvas.getBoundingClientRect().height); 

        for (let i = 0; i < inputs.length; i++) {
            if (Math.abs(y - parseInt(inputs[i].value, 10)) <= tolerance) {
                isDragging = true;
                draggedLineIndex = i;
                previewCanvas.style.cursor = 'ns-resize';
                break;
            }
        }
    });

    previewCanvas.addEventListener('pointermove', (e) => {
        if (!loadedImage || currentMode !== 'vertical') return;
        const y = getPointerY(e);

        if (isDragging && draggedLineIndex !== -1) {
            const inputs = Array.from(document.querySelectorAll('.cut-input'));
            let newY = Math.max(1, Math.min(Math.round(y), loadedImage.height - 1));
            
            if (draggedLineIndex > 0) newY = Math.max(newY, parseInt(inputs[draggedLineIndex - 1].value, 10) + 1);
            if (draggedLineIndex < inputs.length - 1) newY = Math.min(newY, parseInt(inputs[draggedLineIndex + 1].value, 10) - 1);
            
            inputs[draggedLineIndex].value = newY;
            
            // ç·šãŒå‹•ããŸã³ã«æç”»é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€Xãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
            drawPreview();
            
        } else {
            const inputs = Array.from(document.querySelectorAll('.cut-input'));
            const tolerance = 20 * (previewCanvas.height / previewCanvas.getBoundingClientRect().height);
            const isHovering = inputs.some(input => Math.abs(y - parseInt(input.value, 10)) <= tolerance);
            previewCanvas.style.cursor = isHovering ? 'ns-resize' : 'crosshair';
        }
    });

    const endDrag = (e) => {
        if(isDragging) {
            isDragging = false;
            draggedLineIndex = -1;
            previewCanvas.releasePointerCapture(e.pointerId);
            previewCanvas.style.cursor = 'crosshair';
        }
    };
    previewCanvas.addEventListener('pointerup', endDrag);
    previewCanvas.addEventListener('pointercancel', endDrag);

    // --- æœ¬ç•ªã®å‡¦ç†ã¨å‡ºåŠ› ---
    processBtn.addEventListener('click', () => {
        if (!loadedImage) return;
        processBtn.disabled = true;
        resultContainer.innerHTML = ''; 
        
        setTimeout(() => {
            try {
                const workCanvas = document.createElement('canvas');
                const workCtx = workCanvas.getContext('2d');
                let count = 0;

                if (currentMode === 'vertical') {
                    let cuts = Array.from(document.querySelectorAll('.cut-input'))
                        .map(input => parseInt(input.value, 10))
                        .filter(y => y > 0 && y < loadedImage.height);
                    cuts.push(0, loadedImage.height);
                    cuts.sort((a, b) => a - b);
                    cuts = [...new Set(cuts)];

                    workCanvas.width = loadedImage.width;
                    for (let i = 0; i < cuts.length - 1; i++) {
                        const h = cuts[i + 1] - cuts[i];
                        workCanvas.height = h;
                        workCtx.drawImage(loadedImage, 0, cuts[i], loadedImage.width, h, 0, 0, loadedImage.width, h);
                        createResultItem(workCanvas.toDataURL('image/png'), ++count);
                    }
                } else {
                    const rows = parseInt(gridRowsInput.value, 10) || 1;
                    const cols = parseInt(gridColsInput.value, 10) || 1;
                    const sliceW = Math.floor(loadedImage.width / cols);
                    const sliceH = Math.floor(loadedImage.height / rows);

                    workCanvas.width = sliceW;
                    workCanvas.height = sliceH;

                    for (let r = 0; r < rows; r++) {
                        for (let c = 0; c < cols; c++) {
                            workCtx.clearRect(0, 0, sliceW, sliceH);
                            workCtx.drawImage(loadedImage, c * sliceW, r * sliceH, sliceW, sliceH, 0, 0, sliceW, sliceH);
                            createResultItem(workCanvas.toDataURL('image/png'), ++count);
                        }
                    }
                }

                resultArea.style.display = 'block';
                resultArea.scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
            } finally {
                processBtn.disabled = false;
            }
        }, 50);
    });

    function createResultItem(dataUrl, index) {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'result-item';
        const img = document.createElement('img');
        img.src = dataUrl;
        const fileName = `slice_${String(index).padStart(2, '0')}.png`;
        const downloadBtn = document.createElement('a');
        downloadBtn.href = dataUrl;
        downloadBtn.download = fileName;
        downloadBtn.className = 'download-btn individual-download-btn';
        downloadBtn.textContent = `â¬‡ï¸ ${fileName}`;
        itemDiv.appendChild(img);
        itemDiv.appendChild(downloadBtn);
        resultContainer.appendChild(itemDiv);
    }

    // ä¸€æ‹¬ä¿å­˜
    downloadAllBtn.addEventListener('click', async () => {
        const links = document.querySelectorAll('.individual-download-btn');
        if (links.length === 0) return;
        if (!confirm('å…¨ã¦ã®ç”»åƒã‚’é †ç•ªã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆã¯ã€Œè¨±å¯ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚')) return;

        downloadAllBtn.disabled = true;
        downloadAllBtn.textContent = 'ğŸ“¦ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...';

        for (let i = 0; i < links.length; i++) {
            links[i].click();
            await new Promise(resolve => setTimeout(resolve, 500));
        }
        downloadAllBtn.textContent = 'âœ… å®Œäº†ï¼';
        setTimeout(() => {
            downloadAllBtn.disabled = false;
            downloadAllBtn.textContent = 'ğŸ“¦ ã™ã¹ã¦ä¸€æ‹¬ä¿å­˜';
        }, 3000);
    });

    function loadImage(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.onerror = reject;
            img.src = URL.createObjectURL(file);
        });
    }
</script>

</body>
</html>
